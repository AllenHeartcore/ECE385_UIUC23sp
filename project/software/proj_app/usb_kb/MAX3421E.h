#ifndef _MAX3421E_H_
#define _MAX3421E_H_
#define SMPEND 0x80
#define SMPMID 0x00
#define MODE_00 0
#define MODE_01 1
#define MODE_10 2
#define MODE_11 3
#define SSPENB 0x20
#define SPI_FOSC_4 0
#define SPI_FOSC_16 1
#define SPI_FOSC_64 2
#define SPI_FOSC_TMR2 3
#define SLV_SSON 4
#define SLV_SSOFF 5
#define rRCVFIFO	0x08
#define rSNDFIFO	0x10
#define rSUDFIFO	0x20
#define rRCVBC		0x30
#define rSNDBC		0x38
#define rUSBIRQ		0x68
#define bmVBUSIRQ 0x40
#define bmNOVBUSIRQ 0x20
#define bmOSCOKIRQ 0x01
#define	rUSBIEN		0x70
#define bmVBUSIE 0x40
#define bmNOVBUSIE 0x20
#define bmOSCOKIE 0x01
#define rUSBCTL 	0x78
#define bmCHIPRES 0x20
#define bmPWRDOWN 0x10
#define rCPUCTL		0x80
#define bmPUSLEWID1	0x80
#define bmPULSEWID0 0x40
#define bmIE 0x01
#define rPINCTL 	0x88
#define bmFDUPSPI 0x10
#define bmINTLEVEL 0x08
#define bmPOSINT 0x04
#define bmGPXB 0x02
#define	bmGPXA 0x01
#define GPX_OPERATE	0x00
#define GPX_VBDET	0x01
#define GPX_BUSACT	0x02
#define GPX_SOF		0x03
#define rREVISION 	0x90
#define rIOPINS1 	0xa0
#define bmGPOUT0 0x01
#define bmGPOUT1 0x02
#define bmGPOUT2 0x04
#define bmGPOUT3 0x08
#define bmGPIN0 0x10
#define bmGPIN1 0x20
#define bmGPIN2 0x40
#define bmGPIN3 0x80
#define rIOPINS2 	0xa8
#define bmGPOUT4 0x01
#define bmGPOUT5 0x02
#define bmGPOUT6 0x04
#define bmGPOUT7 0x08
#define bmGPIN4 0x10
#define bmGPIN5 0x20
#define bmGPIN6 0x40
#define bmGPIN7 0x80
#define rGPINIRQ	0xb0
#define bmGPINIRQ0 0x01
#define bmGPINIRQ1 0x02
#define bmGPINIRQ2 0x04
#define bmGPINIRQ3 0x08
#define bmGPINIRQ4 0x10
#define bmGPINIRQ5 0x20
#define bmGPINIRQ6 0x40
#define bmGPINIRQ7 0x80
#define rGPINIEN	0xb8
#define bmGPINIEN0 0x01
#define bmGPINIEN1 0x02
#define bmGPINIEN2 0x04
#define bmGPINIEN3 0x08
#define bmGPINIEN4 0x10
#define bmGPINIEN5 0x20
#define bmGPINIEN6 0x40
#define bmGPINIEN7 0x80
#define rGPINPOL 	0xc0
#define bmGPINPOL0 0x01
#define bmGPINPOL1 0x02
#define bmGPINPOL2 0x04
#define bmGPINPOL3 0x08
#define bmGPINPOL4 0x10
#define bmGPINPOL5 0x20
#define bmGPINPOL6 0x40
#define bmGPINPOL7 0x80
#define rHIRQ		0xc8
#define bmBUSEVENTIRQ 0x01
#define bmRWUIRQ 0x02
#define bmRCVDAVIRQ 0x04
#define bmSNDBAVIRQ 0x08
#define bmSUSDNIRQ 0x10
#define bmCONDETIRQ 0x20
#define bmFRAMEIRQ 0x40
#define bmHXFRDNIRQ 0x80
#define rHIEN 		0xd0
#define bmBUSEVENTIE 0x01
#define bmRWUIE 0x02
#define bmRCVDAVIE 0x04
#define bmSNDBAVIE 0x08
#define bmSUSDNIE 0x10
#define bmCONDETIE 0x20
#define bmFRAMEIE 0x40
#define bmHXFRDNIE 0x80
#define rMODE		0xd8
#define bmHOST 0x01
#define bmLOWSPEED 0x02
#define bmHUBPRE 0x04
#define bmSOFKAENAB 0x08
#define bmSEPIRQ 0x10
#define bmDELAYISO 0x20
#define bmDMPULLDN 0x40
#define bmDPPULLDN 0x80
#define rPERADDR	0xe0
#define rHCTL		0xe8
#define bmBUSRST 0x01
#define bmFRMRST 0x02
#define bmSAMPLEBUS 0x04
#define bmSIGRSM 0x08
#define bmRCVTOG0 0x10
#define bmRCVTOG1 0x20
#define bmSNDTOG0 0x40
#define bmSNDTOG1 0x80
#define rHXFR		0xf0
#define tokSETUP 0x10
#define tokIN 0x00
#define tokOUT 0x20
#define tokINHS 0x80
#define tokOUTHS 0xA0
#define tokISOIN 0x40
#define tokISOOUT 0x60
#define rHRSL		0xf8
#define bmRCVTOGRD	0x10
#define bmSNDTOGRD	0x20
#define bmKSTATUS	0x40
#define bmJSTATUS	0x80
#define bmSE0		0x00
#define bmSE1		0xc0
#define hrSUCCESS 0x00
#define hrBUSY 0x01
#define hrBADREQ 0x02
#define hrUNDEF 0x03
#define hrNAK 0x04
#define hrSTALL 0x05
#define hrTOGERR 0x06
#define hrWRONGPID 0x07
#define hrBADBC 0x08
#define hrPIDERR 0x09
#define hrPKTERR 0x0A
#define hrCRCERR 0x0B
#define hrKERR 0x0C
#define hrJERR 0x0D
#define hrTIMEOUT 0x0E
#define hrBABBLE 0x0F
#define MODE_FS_HOST	(bmDPPULLDN|bmDMPULLDN|bmHOST|bmSOFKAENAB)
#define MODE_LS_HOST	(bmDPPULLDN|bmDMPULLDN|bmHOST|bmLOWSPEED|bmSOFKAENAB)
void SPI_init(BYTE sync_mode, BYTE bus_mode, BYTE smp_phase);
void MAXreg_wr(BYTE reg, BYTE val);
BYTE* MAXbytes_wr(BYTE reg, BYTE nbytes, BYTE * data);
BYTE MAXreg_rd(BYTE reg);
BYTE* MAXbytes_rd(BYTE reg, BYTE nbytes, BYTE *data);
void MAX3421E_reset(void);
BOOL Vbus_power(BOOL action);
void MAX3421E_init(void);
void MAX_busprobe(void);
void MAX3421E_Task(void);
void MaxIntHandler(void);
void MaxGpxHandler(void);
#endif
